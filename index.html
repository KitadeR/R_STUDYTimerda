<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>勉強時間記録</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f7f7f7;
    }
    h1, h2, h3 {
      color: #333;
    }
    .input-area, .subject-management, #summaryTable, .add-record {
      background: #fff;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    label {
      display: inline-block;
      width: 80px;
      margin-right: 10px;
    }
    input[type="text"], input[type="datetime-local"], select {
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      width: 200px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 8px 15px;
      margin-top: 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    button:hover {
      background-color: #45a049;
    }
    ul {
      list-style-type: none;
      padding-left: 0;
    }
    ul li {
      background: #fff;
      margin-bottom: 5px;
      padding: 10px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer; /* カーソルをポインターに変更してクリック可能であることを示す */
    }
    ul li button {
      background-color: #e74c3c;
      padding: 5px 10px;
      font-size: 12px;
    }
    ul li button:hover {
      background-color: #c0392b;
    }
    #dailyTotal {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    #studyChart {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      max-width: 800px;
      max-height: 400px;
    }
    .record-control {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
    }
    #startTimeDisplay {
      margin-left: 10px;
      font-size: 1em;
      color: #555;
    }
    #summaryTable table {
      width: 100%;
      border-collapse: collapse;
    }
    #summaryTable th, #summaryTable td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    #summaryTable th {
      background-color: #f0f0f0;
    }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, collection, addDoc, orderBy, Timestamp, onSnapshot, query, deleteDoc, doc, getDocs, where } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAQGXHwTEcg-xGKvFi1V-vIPJwS-PR4_7Y",
      authDomain: "studytimerda.firebaseapp.com",
      projectId: "studytimerda",
      storageBucket: "studytimerda.firebasestorage.app",
      messagingSenderId: "528673388784",
      appId: "1:528673388784:web:34b5826cd213ee6a0c6a35"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);
    const recordsCollection = collection(db, 'studyRecords');
    const subjectsCollection = collection(db, 'subjects');

    let allRecords = []; // ← グローバルで宣言

    document.addEventListener('DOMContentLoaded', () => {
      const subjectInput = document.getElementById('subject');
      const startTimeInput = document.getElementById('startTime');
      const endTimeInput = document.getElementById('endTime');
      const recordButton = document.getElementById('recordButton');
      const addSubjectInput = document.getElementById('addSubject');
      const addSubjectButton = document.getElementById('addSubjectButton');
      const subjectList = document.getElementById('subjectList');
      const recordList = document.getElementById('recordList');
      const showMoreRecordsButton = document.getElementById('showMoreRecordsButton');
      let showingAll = false;

      const dailyTotalDiv = document.getElementById('dailyTotal');
      const studyChartCtx = document.getElementById('studyChart').getContext('2d');
      const startButton = document.createElement('button');
      startButton.textContent = '開始';
      const endButton = document.createElement('button');
      endButton.textContent = '終了';
      const startTimeDisplay = document.createElement('span');
      startTimeDisplay.id = 'startTimeDisplay';
      let currentStartTime;
      let elapsedTimerId = null; // ← 追加

      // ▼▼ ローカルストレージから復元 ▼▼
      if (localStorage.getItem('studyTimer_currentStartTime')) {
        currentStartTime = new Date(localStorage.getItem('studyTimer_currentStartTime'));
        if (!isNaN(currentStartTime)) {
          startTimeDisplay.textContent = `開始: ${currentStartTime.toLocaleTimeString()}　経過: 0秒`;
          // 経過時間タイマー再開
          if (elapsedTimerId) clearInterval(elapsedTimerId);
          elapsedTimerId = setInterval(() => {
            const now = new Date();
            const elapsedMs = now - currentStartTime;
            const elapsedSec = Math.floor(elapsedMs / 1000);
            const h = Math.floor(elapsedSec / 3600);
            const m = Math.floor((elapsedSec % 3600) / 60);
            const s = elapsedSec % 60;
            let elapsedStr = '';
            if (h > 0) elapsedStr += `${h}時間`;
            if (m > 0 || h > 0) elapsedStr += `${m}分`;
            elapsedStr += `${s}秒`;
            startTimeDisplay.textContent = `開始: ${currentStartTime.toLocaleTimeString()}　経過: ${elapsedStr}`;
          }, 1000);
        }
      }
      if (localStorage.getItem('studyTimer_subject')) {
        subjectInput.value = localStorage.getItem('studyTimer_subject');
      }
      // ▲▲ ローカルストレージから復元 ▲▲

      const summaryTableDiv = document.getElementById('summaryTable');

      let studyChart;

      const inputAreaDiv = document.querySelector('.input-area > div:first-child').parentNode;
      const recordControlDiv = document.createElement('div');
      recordControlDiv.classList.add('record-control');
      recordControlDiv.appendChild(startButton);
      recordControlDiv.appendChild(endButton);
      recordControlDiv.appendChild(startTimeDisplay);
      inputAreaDiv.appendChild(recordControlDiv);

      // ★ 修正: ここで summaryTableDiv を追加するのは一度だけにします
      if (!document.getElementById('summaryTable')) {
        const newSummaryTableDiv = document.createElement('div');
        newSummaryTableDiv.id = 'summaryTable';
        document.body.appendChild(newSummaryTableDiv);
        newSummaryTableDiv.innerHTML = '<h2>科目別・日付別 合計勉強時間</h2><table><thead><tr><th>日付</th><th>科目</th><th>合計時間</th></tr></thead><tbody id="summaryTableBody"></tbody></table>';
      }
      const summaryTableBody = document.getElementById('summaryTableBody');

      // 勉強時間を追加するための要素を取得
      const addSubjectSelect = document.getElementById('addSubjectSelect');
      const addStartTime = document.getElementById('addStartTime');
      const addEndTime = document.getElementById('addEndTime');
      const addRecordButton = document.getElementById('addRecordButton');

      // 科目リストをドロップダウンに表示
      const qSubjects = query(subjectsCollection, orderBy('name'));
      onSnapshot(qSubjects, (snapshot) => {
        addSubjectSelect.innerHTML = '<option value="">選択してください</option>';
        snapshot.forEach(docSnap => {
          const subject = docSnap.data().name;
          const option = document.createElement('option');
          option.value = subject;
          option.textContent = subject;
          addSubjectSelect.appendChild(option);
        });
      });

      // 勉強時間を追加する処理
      addRecordButton.addEventListener('click', async () => {
        const subject = addSubjectSelect.value;
        const startTime = addStartTime.value;
        const endTime = addEndTime.value;

        if (!subject || !startTime || !endTime) {
          alert('すべての項目を入力してください');
          return;
        }

        const start = new Date(startTime);
        const end = new Date(endTime);

        if (start >= end) {
          alert('開始時刻は終了時刻より前である必要があります');
          return;
        }

        try {
          await addDoc(recordsCollection, {
            subject: subject,
            startTime: Timestamp.fromDate(start),
            endTime: Timestamp.fromDate(end)
          });
          alert('勉強時間を追加しました');
          addStartTime.value = '';
          addEndTime.value = '';
          addSubjectSelect.value = '';
        } catch (error) {
          alert('勉強時間の追加に失敗しました: ' + error.message);
          console.error('勉強時間の追加エラー:', error);
        }
      });

      // Load subjects and listen for changes
      onSnapshot(qSubjects, (snapshot) => {
        subjectList.innerHTML = '';
        snapshot.forEach(docSnap => {
          const subject = docSnap.data().name;
          const li = document.createElement('li');
          li.textContent = subject;
          li.addEventListener('click', () => {
            subjectInput.value = subject;
          });
          const deleteBtn = document.createElement('button');
          deleteBtn.textContent = '削除';
          deleteBtn.addEventListener('click', async () => {
            if(confirm(`科目「${subject}」を削除しますか？`)){
              await deleteDoc(doc(db, 'subjects', docSnap.id));
            }
          });
          li.appendChild(deleteBtn);
          subjectList.appendChild(li);
        });
      });

      // Add new subject
      addSubjectButton.addEventListener('click', async () => {
        const newSubject = addSubjectInput.value.trim();
        if(newSubject === '') {
          alert('科目名を入力してください');
          return;
        }
        try {
          const qExisting = query(subjectsCollection, where('name', '==', newSubject));
          const existingSnapshot = await getDocs(qExisting);
          if (!existingSnapshot.empty) {
            alert('その科目は既に存在します');
            return;
          }
          await addDoc(subjectsCollection, { name: newSubject });
          addSubjectInput.value = '';
        } catch (error) {
          alert('科目の追加に失敗しました: ' + error.message);
          console.error('科目の追加エラー:', error);
        }
      });

      // Start timer
      startButton.addEventListener('click', () => {
        currentStartTime = new Date();
        startTimeDisplay.textContent = `開始: ${currentStartTime.toLocaleTimeString()}　経過: 0秒`;
        endTimeInput.value = ''; // Clear end time input

        // ▼▼ ローカルストレージに保存 ▼▼
        localStorage.setItem('studyTimer_currentStartTime', currentStartTime.toISOString());
        localStorage.setItem('studyTimer_subject', subjectInput.value.trim());
        // ▲▲ ローカルストレージに保存 ▲▲

        // 経過時間タイマー開始
        if (elapsedTimerId) clearInterval(elapsedTimerId);
        elapsedTimerId = setInterval(() => {
          const now = new Date();
          const elapsedMs = now - currentStartTime;
          const elapsedSec = Math.floor(elapsedMs / 1000);
          const h = Math.floor(elapsedSec / 3600);
          const m = Math.floor((elapsedSec % 3600) / 60);
          const s = elapsedSec % 60;
          let elapsedStr = '';
          if (h > 0) elapsedStr += `${h}時間`;
          if (m > 0 || h > 0) elapsedStr += `${m}分`;
          elapsedStr += `${s}秒`;
          startTimeDisplay.textContent = `開始: ${currentStartTime.toLocaleTimeString()}　経過: ${elapsedStr}`;
        }, 1000);
      });

      // 科目入力欄が変更されたらローカルストレージに保存
      subjectInput.addEventListener('input', () => {
        localStorage.setItem('studyTimer_subject', subjectInput.value.trim());
      });

      // End timer and record
      endButton.addEventListener('click', async () => {
        if (!currentStartTime) {
          alert('「開始」ボタンを押して時間を計測してください。');
          return;
        }
        const endTime = new Date();
        endTimeInput.value = endTime.toISOString().slice(0, 16).replace('T', ' '); // Set end time input for visual feedback

        const subject = subjectInput.value.trim();
        if(subject === '') {
          alert('科目を入力してください');
          return;
        }

        try {
          await addDoc(recordsCollection, {
            subject: subject,
            startTime: Timestamp.fromDate(currentStartTime),
            endTime: Timestamp.fromDate(endTime)
          });
          subjectInput.value = '';
          startTimeDisplay.textContent = '';
          currentStartTime = null;
          endTimeInput.value = '';
          if (elapsedTimerId) {
            clearInterval(elapsedTimerId);
            elapsedTimerId = null;
          }
          // ▼▼ ローカルストレージをクリア ▼▼
          localStorage.removeItem('studyTimer_currentStartTime');
          localStorage.removeItem('studyTimer_subject');
          // ▲▲ ローカルストレージをクリア ▲▲
        } catch (e) {
          alert('記録の追加に失敗しました: ' + e.message);
        }
      });

      // 記録のリアルタイム表示・グラフ・テーブル
      const qRecords = query(recordsCollection, orderBy('startTime', 'desc'));
      onSnapshot(qRecords, (snapshot) => {
        // 記録一覧
        recordList.innerHTML = '';
        allRecords.length = 0; // 中身だけクリア
        snapshot.forEach(docSnap => {
          allRecords.push(docSnap);
          const data = docSnap.data();
          const start = data.startTime.toDate();
          const end = data.endTime.toDate();
          const durationMinutes = (end - start) / 1000 / 60;
          const subject = data.subject;
          const durationDisplay = durationMinutes < 60 ? `${Math.floor(durationMinutes)}分` : `${(durationMinutes / 60).toFixed(2)}時間`;

          const li = document.createElement('li');
          li.textContent = `${subject} : ${start.toLocaleString()} 〜 ${end.toLocaleString()} （${durationDisplay}）`;
          const deleteBtn = document.createElement('button');
          deleteBtn.textContent = '削除';
          deleteBtn.addEventListener('click', async () => {
            if(confirm('この記録を削除しますか？')){
              await deleteDoc(doc(db, 'studyRecords', docSnap.id));
            }
          });
          li.appendChild(deleteBtn);
          recordList.appendChild(li);
        });

        // グラフ描画
        const dateTotals = {};
        allRecords.forEach(docSnap => {
          const data = docSnap.data();
          const start = data.startTime.toDate();
          const end = data.endTime.toDate();
          // YYYY-MM-DD形式で統一
          const dateStr = start.toISOString().slice(0, 10);
          const durationMinutes = (end - start) / 1000 / 60;
          if (!dateTotals[dateStr]) dateTotals[dateStr] = 0;
          dateTotals[dateStr] += durationMinutes / 60;
        });
        // 日付で昇順ソート
        const chartLabels = Object.keys(dateTotals).sort((a, b) => new Date(a) - new Date(b));
        const chartData = chartLabels.map(date => dateTotals[date]);

        if (studyChart) {
          studyChart.data.labels = chartLabels;
          studyChart.data.datasets[0].data = chartData;
          studyChart.update();
        } else {
          studyChart = new Chart(studyChartCtx, {
            type: 'bar',
            data: {
              labels: chartLabels,
              datasets: [{
                label: '合計勉強時間（時間）',
                data: chartData,
                backgroundColor: '#4CAF50'
              }]
            },
            options: {
              responsive: true,
              plugins: {
                legend: { display: false }
              },
              scales: {
                y: { beginAtZero: true, title: { display: true, text: '時間' } }
              }
            }
          });
        }

        // テーブル描画
        const summary = {};
        allRecords.forEach(docSnap => {
          const data = docSnap.data();
          const start = data.startTime.toDate();
          const end = data.endTime.toDate();
          const dateStr = start.toISOString().slice(0, 10); // YYYY-MM-DD
          const subject = data.subject;
          const durationMinutes = (end - start) / 1000 / 60;
          if (!summary[dateStr]) summary[dateStr] = {};
          if (!summary[dateStr][subject]) summary[dateStr][subject] = 0;
          summary[dateStr][subject] += durationMinutes;
        });

        summaryTableBody.innerHTML = '';
        Object.keys(summary)
          .sort((a, b) => new Date(a) - new Date(b)) // 日付で昇順
          .forEach(date => {
            Object.keys(summary[date]).forEach(subject => {
              const tr = document.createElement('tr');
              const tdDate = document.createElement('td');
              tdDate.textContent = date;
              const tdSubject = document.createElement('td');
              tdSubject.textContent = subject;
              const tdTotal = document.createElement('td');
              tdTotal.textContent = summary[date][subject] < 60
                ? `${Math.floor(summary[date][subject])}分`
                : `${(summary[date][subject] / 60).toFixed(2)}時間`;
              tr.appendChild(tdDate);
              tr.appendChild(tdSubject);
              tr.appendChild(tdTotal);
              summaryTableBody.appendChild(tr);
            });
          });

        // ▼▼ ここを追加 ▼▼
        updateMonthOptions(allRecords);
        // デフォルトは最新月
        if (monthSelect.options.length > 0 && !monthSelect.value) {
          monthSelect.value = monthSelect.options[monthSelect.options.length - 1].value;
        }
        renderMonthlySummary(allRecords, monthSelect.value);
      });

      function renderRecordList() {
        recordList.innerHTML = '';
        const recordsToShow = showingAll ? allRecords : allRecords.slice(0, 5);
        recordsToShow.forEach(docSnap => {
          const data = docSnap.data();
          const start = data.startTime.toDate();
          const end = data.endTime.toDate();
          const durationMinutes = (end - start) / 1000 / 60;
          const subject = data.subject;
          const durationDisplay = durationMinutes < 60 ? `${Math.floor(durationMinutes)}分` : `${(durationMinutes / 60).toFixed(2)}時間`;

          const li = document.createElement('li');
          li.textContent = `${subject} : ${start.toLocaleString()} 〜 ${end.toLocaleString()} （${durationDisplay}）`;
          const deleteBtn = document.createElement('button');
          deleteBtn.textContent = '削除';
          deleteBtn.addEventListener('click', async () => {
            if(confirm('この記録を削除しますか？')){
              await deleteDoc(doc(db, 'studyRecords', docSnap.id));
            }
          });
          li.appendChild(deleteBtn);
          recordList.appendChild(li);
        });
      }

      showMoreRecordsButton.addEventListener('click', () => {
        showingAll = !showingAll;
        renderRecordList();
        showMoreRecordsButton.textContent = showingAll ? '閉じる' : 'もっと見る';
      });

      // 月間総勉強時間の表示
      const monthSelect = document.getElementById('monthSelect');
      const monthlySummaryBody = document.getElementById('monthlySummaryBody');

      // 月選択肢の生成
      for (let m = 0; m < 12; m++) {
        const monthOption = document.createElement('option');
        monthOption.value = m;
        monthOption.textContent = `${m + 1}月`;
        monthSelect.appendChild(monthOption);
      }

      // 月間総勉強時間の取得と表示
      monthSelect.addEventListener('change', async () => {
        const selectedMonth = parseInt(monthSelect.value);
        if (isNaN(selectedMonth)) return;

        // 1日から月末までの範囲を取得
        const startOfMonth = new Date(new Date().getFullYear(), selectedMonth, 1);
        const endOfMonth = new Date(new Date().getFullYear(), selectedMonth + 1, 0, 23, 59, 59);

        const qMonthlySummary = query(recordsCollection, where('startTime', '>=', Timestamp.fromDate(startOfMonth)), where('endTime', '<=', Timestamp.fromDate(endOfMonth)), orderBy('subject'));
        onSnapshot(qMonthlySummary, (snapshot) => {
          monthlySummaryBody.innerHTML = '';
          const monthlyTotals = {};
          snapshot.forEach(docSnap => {
            const data = docSnap.data();
            const subject = data.subject;
            const start = data.startTime.toDate();
            const end = data.endTime.toDate();
            const durationMinutes = (end - start) / 1000 / 60;
            if (!monthlyTotals[subject]) monthlyTotals[subject] = 0;
            monthlyTotals[subject] += durationMinutes;
          });

          Object.keys(monthlyTotals).forEach(subject => {
            const tr = document.createElement('tr');
            const tdSubject = document.createElement('td');
            tdSubject.textContent = subject;
            const tdTotal = document.createElement('td');
            tdTotal.textContent = monthlyTotals[subject] < 60
              ? `${Math.floor(monthlyTotals[subject])}分`
              : `${(monthlyTotals[subject] / 60).toFixed(2)}時間`;
            tr.appendChild(tdSubject);
            tr.appendChild(tdTotal);
            monthlySummaryBody.appendChild(tr);
          });
        });
      });

      // 初期表示は今月に設定
      const now = new Date();
      monthSelect.value = now.getMonth();
      monthSelect.dispatchEvent(new Event('change'));

      // 月選択肢をセット
      function updateMonthOptions(allRecords) {
        const months = new Set();
        allRecords.forEach(docSnap => {
          const data = docSnap.data();
          const start = data.startTime.toDate();
          const ym = `${start.getFullYear()}-${String(start.getMonth() + 1).padStart(2, '0')}`;
          months.add(ym);
        });
        const sortedMonths = Array.from(months).sort((a, b) => new Date(a + '-01') - new Date(b + '-01'));
        monthSelect.innerHTML = '';
        sortedMonths.forEach(ym => {
          const option = document.createElement('option');
          option.value = ym;
          option.textContent = ym.replace('-', '年') + '月';
          monthSelect.appendChild(option);
        });
      }

      // 月ごとの科目別合計を計算して表に描画
      function renderMonthlySummary(allRecords, selectedMonth) {
        const subjectTotals = {};
        allRecords.forEach(docSnap => {
          const data = docSnap.data();
          const start = data.startTime.toDate();
          const ym = `${start.getFullYear()}-${String(start.getMonth() + 1).padStart(2, '0')}`;
          if (ym !== selectedMonth) return;
          const subject = data.subject;
          const end = data.endTime.toDate();
          const durationMinutes = (end - start) / 1000 / 60;
          if (!subjectTotals[subject]) subjectTotals[subject] = 0;
          subjectTotals[subject] += durationMinutes;
        });
        monthlySummaryBody.innerHTML = '';
        Object.keys(subjectTotals).sort().forEach(subject => {
          const tr = document.createElement('tr');
          const tdSubject = document.createElement('td');
          tdSubject.textContent = subject;
          const tdTotal = document.createElement('td');
          tdTotal.textContent = subjectTotals[subject] < 60
            ? `${Math.floor(subjectTotals[subject])}分`
            : `${(subjectTotals[subject] / 60).toFixed(2)}時間`;
          tr.appendChild(tdSubject);
          tr.appendChild(tdTotal);
          monthlySummaryBody.appendChild(tr);
        });
      }

      // 月選択時に再描画
      monthSelect.addEventListener('change', () => {
        renderMonthlySummary(allRecords, monthSelect.value);
      });
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>勉強時間記録</h1>

  <div class="input-area">
    <div>
      <label for="subject">科目:</label>
      <input type="text" id="subject">
    </div>
    <div>
      <label for="startTime">開始時刻:</label>
      <input type="datetime-local" id="startTime" style="display: none;">
    </div>
    <div>
      <label for="endTime">終了時刻:</label>
      <input type="datetime-local" id="endTime">
    </div>
  </div>

  <div class="add-record">
    <h2>勉強時間を追加</h2>
    <div>
      <label for="addSubjectSelect">科目:</label>
      <select id="addSubjectSelect"></select>
    </div>
    <div>
      <label for="addStartTime">開始時刻:</label>
      <input type="datetime-local" id="addStartTime">
    </div>
    <div>
      <label for="addEndTime">終了時刻:</label>
      <input type="datetime-local" id="addEndTime">
    </div>
    <button id="addRecordButton">記録を追加</button>
  </div>

  <div class="subject-management">
    <h2>科目管理</h2>
    <input type="text" id="addSubject" placeholder="新しい科目">
    <button id="addSubjectButton">追加</button>
    <h3>科目一覧</h3>
    <ul id="subjectList"></ul>
  </div>

  <h2>記録一覧</h2>
  <ul id="recordList"></ul>
  <button id="showMoreRecordsButton" style="display:none;">もっと見る</button>

  <div id="dailyTotal"></div>

  <!-- ▼▼▼ ここを移動 ▼▼▼ -->
  <div id="monthlySummaryArea" class="input-area">
    <h2>科目別 月間総勉強時間</h2>
    <label for="monthSelect">月選択：</label>
    <select id="monthSelect"></select>
    <table>
      <thead>
        <tr>
          <th>科目</th>
          <th>合計時間</th>
        </tr>
      </thead>
      <tbody id="monthlySummaryBody"></tbody>
    </table>
  </div>
  <!-- ▲▲▲ ここを移動 ▲▲▲ -->

  <h2>勉強時間の推移</h2>
  <canvas id="studyChart"></canvas>

  <div id="summaryTable">
    <h2>科目別・日付別 合計勉強時間</h2>
    <table>
      <thead>
        <tr>
          <th>日付</th>
          <th>科目</th>
          <th>合計時間</th>
        </tr>
      </thead>
      <tbody id="summaryTableBody">
      </tbody>
    </table>
  </div>
</body>
</html>